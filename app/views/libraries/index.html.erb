<%= tag.div(flash[:notice], style: "color:red") if flash[:notice] %>

<%= form_with url: books_path, method: :post do |form| %>
  <%= form.label :isbn%>
  <%= form.text_field :isbn %>
  <%= form.submit "Add Book" %>

<% end %>

<h1>My Library</h1>
<h2>Books</h2>

<table>
  <thead>
    <tr>
      <th>ISBN</th>
      <th>Title</th>
      <th>Authors</th>
      <th>Subjects</th>
      <th>Actions</th>
      <th>Price Search</th>
    </tr>
  </thead>
  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.isbn %></td>
        <td><%= book.title %></td>
        <td><%= book.authors.map(&:name).join(", ") %></td>
        <td><%= book.subjects.map(&:description).join(", ") %></td>
        <td>
          <%= button_to "Delete", delete_book_libraries_path(book), method: :delete %>
          <%= button_to "Serch Prices", book_search_prices_path(book), method: :post %>
        </td>
        <td>
          <ul>
            <%= render partial: 'libraries/search_price', collection: book.search_prices, cached: true %>
          </ul>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
